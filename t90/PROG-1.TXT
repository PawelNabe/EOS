50 CLEAR400,&HF36E:DIMDAT$(51),N%(6)
65 FORI=1TO10:KEYI,"**":NEXTI:FORI=1TO51:DAT$(I)="      ":NEXTI
75 N%(1)=&H5A:N%(2)=&H44:VD%=1:CP%=1
90 SY$="00":SM$="00":SD$="00":IY$="00":IM$="00":ID$="00":EY$="00":EM$="00":ED$="00":FR$="00"
130 OPEN"GRP:"FOROUTPUTAS#1
170 GOSUB4360:LINE(176,80)-(184,88),15,BF
190 PRESET(192,80):PRINT#1,"JAPANESE":DRAW"BM176,104R8D8L8U8":PRESET(192,104):PRINT#1,"ENGLISH":PRESET(192,88):PRINT#1," ¶À¶Å "
240 PRESET(16,152):PRINT#1,"Ì§Ý¸¼®Ý ·° ¦ µ¼Ã¸ÀÞ»²":PRESET(16,164):PRINT#1,"PUSH FUNCTION KEY"
280 ONKEYGOSUB410,,,,460
290 PRESET(8,184):PRINT#1," ¶À¶Å /    /     /     /ENGLISH":PRESET(8,176)
310 SS$="1":ST$="10001"
330 GOSUB3300
332 B$=INKEY$:IFB$=""GOTO332
334 GOSUB3350
340 IFASC(B$)=30THENIFSS$="2"THENGOSUB5340:SS$="1"
350 IFASC(B$)=31THENIFSS$="1"THENGOSUB5430:SS$="2"
360 IFASC(B$)<>13GOTO330
370 ONVAL(SS$)GOSUB410,460
410 GOSUB3350:SW$="0":RETURN480
460 GOSUB3350:SW$="1":RETURN480
480 LINE(176,80)-(255,128),5,BF:LINE(0,150)-(255,191),5,BF:GOTO560
510 GOSUB4360
560 PRESET(170,60):PRINT#1,"** MENU **":LINE(176,80)-(184,88),15,BF
590 PRESET(192,80):PRINT#1,"TIMER  ":DRAW"BM176,104R8D8L8U8":PRESET(192,104):PRINT#1,"IMPRINT"
640 PRESET(16,160):IFSW$="0"THENPRINT#1,"Ì§Ý¸¼®Ý ·° ¦ µ¼Ã¸ÀÞ»²"ELSEPRINT#1,"PUSH FUNCTION KEY"
660 ONKEYGOSUB760,,,,780
670 PRESET(8,184):PRINT#1," TIMER/    /     /     /IMPRINT"
690 SS$="1":ST$="10001"
710 GOSUB3300
712 B$=INKEY$:IFB$=""GOTO712
714 GOSUB3350
720 IFASC(B$)=30THENIFSS$="2"THENGOSUB5340:SS$="1"
730 IFASC(B$)=31THENIFSS$="1"THENGOSUB5430:SS$="2"
740 IFASC(B$)<>13GOTO710
750 ONVAL(SS$)GOSUB760,780
760 GOSUB3350:RETURN880
780 GOSUB3350:RETURN1930
880 '
882 A$=INKEY$:IFA$<>""GOTO882
885 PRINTFRE(""):GOSUB4600
890 FORI%=11TO22:LOCATE0,I%:PRINTTAB(31);:NEXTI%
900 LOCATE11,22:PRINT"       ";:LOCATE5,20:IFSW$="0"THENPRINT"À²Ï° ¦ ¾¯Ä ¼Ã¸ÀÞ»²"ELSEPRINT "SET TIMER"
910 LOCATE0,23:PRINT"       /   /     /TIMER/IMPRINT";
1000 ST$="00011"
1010 ENTRY$=SY$+":"+SM$+" "+SD$
1030 X=15:Y=2:L=8:GOSUB6710:GOSUB7999
1060 IFVAL(MID$(ENTRY$,4,2))>59THENBEEP:GOTO1030
1070 IFVAL(RIGHT$(ENTRY$,2))>59THENBEEP:GOTO1030
1075 SY$=LEFT$(ENTRY$,2):SM$=MID$(ENTRY$,4,2):SD$=RIGHT$(ENTRY$,2):ENTRY$=IY$+":"+IM$+" "+ID$
1090 X=15:Y=4:L=8:GOSUB6710:GOSUB7999
1105 IFVAL(LEFT$(ENTRY$,2))=0ANDVAL(MID$(ENTRY$,4,2))=0AND(VAL(RIGHT$(ENTRY$,2))=1ORVAL(RIGHT$(ENTRY$,2))=2)THENBEEP:GOTO1090
1120 IFVAL(MID$(ENTRY$,4,2))>59THENBEEP:GOTO1090
1130 IFVAL(RIGHT$(ENTRY$,2))>59THENBEEP:GOTO1090
1135 IY$=LEFT$(ENTRY$,2):IM$=MID$(ENTRY$,4,2):ID$=RIGHT$(ENTRY$,2):ENTRY$=EY$+":"+EM$+" "+ED$
1150 X=15:Y=6:L=8:GOSUB6710:GOSUB7999
1170 IFVAL(LEFT$(ENTRY$,2))=0ANDVAL(MID$(ENTRY$,4,2))=0AND(VAL(RIGHT$(ENTRY$,2))=1ORVAL(RIGHT$(ENTRY$,2))=2)THENBEEP:GOTO1150
1180 IFVAL(MID$(ENTRY$,4,2))>59THENBEEP:GOTO1150
1190 IFVAL(RIGHT$(ENTRY$,2))>59THENBEEP:GOTO1150
1195 EY$=LEFT$(ENTRY$,2):EM$=MID$(ENTRY$,4,2):ED$=RIGHT$(ENTRY$,2):ENTRY$=FR$
1210 X=21:Y=8:L=2:GOSUB6710:GOSUB7999
1220 IFVAL(ENTRY$)=0THENBEEP:GOTO1210
1230 FR$=ENTRY$:GOTO1236
1235 GOSUB4680
1236 IFVAL(SY$)+VAL(SM$)+VAL(SD$)+VAL(IY$)+VAL(IM$)+VAL(ID$)+VAL(EY$)+VAL(EM$)+VAL(ED$)+VAL(FR$)=0THENBEEP:GOTO1000
1237 IFIY$="00"ANDIM$="00"AND(ID$="01"ORID$="02")THENBEEP:GOTO1000
1238 IFEY$="00"ANDEM$="00"AND(ED$="01"ORED$="02")THENBEEP:GOTO1000
1239 IFVAL(IY$)+VAL(IM$)+VAL(ID$)=0ANDVAL(EY$)+VAL(EM$)+VAL(ED$)<>0ANDVAL(FR$)<>1THENBEEP:GOTO1000ELSEGOTO1290
1250 GOSUB5280:GOTO1010
1290 LOCATE5,19:IFSW$="0"THENPRINT"ÃÞ°À Ê Ö²ÃÞ½¶ ?"ELSEPRINT"DATA OK ?"
1330 LOCATE5,20:IFSW$="0"THENPRINT"Ì§Ý¸¼®Ý·° ¦ µ¼Ã¸ÀÞ»²"ELSEPRINT"PUSH FUNCTION KEY"
1370 LOCATE 11,22:PRINT"IMPRINT";:LOCATE0,23:PRINT" YES  /NO  /     /     ";:ST$="11101"
1410 GOSUB5160
1415 GOSUB3345
1420 B$=INKEY$:IFB$=""THEN1420
1422 GOSUB3395
1425 IFASC(B$)>5THEN1415
1430 IFASC(B$)=1THEN1510
1440 IFASC(B$)=2THEN890
1450 IFASC(B$)=3THENGOSUB5280:GOTO1410
1460 IFASC(B$)=5THEN1930ELSE1420
1510 LOCATE5,19:PRINTTAB(31);:TS=VAL(SY$)*3600+VAL(SM$)*60+VAL(SD$):TI=VAL(IY$)*3600+VAL(IM$)*60+VAL(ID$):TE=VAL(EY$)*3600+VAL(EM$)*60+VAL(ED$)
1560 FF%=VAL(FR$)
1570 IFTS<>0THENGOSUB5940ELSEIFTE<>0THENGOSUB6050ELSEIFTI<>0THENGOSUB5990
1580 LOCATE6,15:PRINT"FRAMES         ";FR$:LOCATE5,20:IFSW$="0"THENPRINT"Ì§Ý¸¼®Ý·° ¦ µ¼Ã¸ÀÞ»²"ELSEPRINT"PUSH FUNCTION KEY"
1620 LOCATE0,22:PRINT" TIMER     IMPRINT";TAB(32);:LOCATE0,23:PRINT"  ON  /    /     /TIMER/IMPRINT";:ST$="10111"
1680 GOSUB5160
1685 GOSUB3345
1690 B$=INKEY$:IFB$=""GOTO1690
1692 GOSUB3395
1695 IFASC(B$)>5THEN1685
1700 IFASC(B$)=1THEN1740
1710 IFASC(B$)=3THENGOSUB5280:GOTO1680
1720 IFASC(B$)=4THEN890
1730 IFASC(B$)=5THEN1930ELSE1685
1740 FORI%=20TO22:LOCATE0,I%:PRINTTAB(31);:NEXTI%:LOCATE 26,22:PRINT"TIMER";:LOCATE0,23:PRINT"      /      /     /     / OFF ";:ONKEYGOSUB,,,,1805
1790 ST$="00001":GOSUB3300:B$="T":GOTO5590
1805 GOSUB3350:INTERVAL OFF:CALL RBOFF
1810 INTERVALOFF:GOSUB3350:RETURN1820
1820 FORI%=11TO21:LOCATE0,I%:PRINTTAB(31);:NEXTI%:GOTO1560
1930 RC=FRE(""):GOSUB4800:PRESET(16,160):IFSW$="0"THENPRINT#1,"ÃÞ°À ¦ ¾¯Ä ¼Ã¸ÀÞ»²"ELSEPRINT#1,"SET IMPRINT DATA"
1960 PSET(16,168),15:PRINT#1,"[0-9, ,-]":PRESET(8,184):PRINT#1," SET OK /    /    /TIMER/    "
1992 PRESET(90,184):COLOR15:DRAW"D8U8F3H3G3":PRESET(99,184):COLOR15:DRAW"D8U8F3H3G3":PRESET(130,184):COLOR15:DRAW"D7H3F3E3":PRESET(139,184):COLOR15:DRAW"D7H3F3E3":GOSUB2480
2050 CX%=1:CP%=1:SP%=1
2055 LINE(0,160)-(255,191),5,BF:PRESET(16,160):IFSW$="0"THENPRINT#1,"Ì§Ý¸¼®Ý·° ¦ µ¼Ã¸ÀÞ»²"ELSEPRINT#1,"PUSH FUNCTION KEY"
2090 PRESET(8,184):PRINT#1," RELEASE/    /   /TIMER/IMPRINT"
2102 PRESET(90,184):COLOR15:DRAW"D8U8F3H3G3":PRESET(99,184):COLOR15:DRAW"D8U8F3H3G3":PRESET(125,184):COLOR15:DRAW"D7H3F3E3":PRESET(134,184):COLOR15:DRAW"D7H3F3E3"
2110 ONKEYGOSUB2200,2360,2330,2310,2195
2120 GOSUB4860
2130 ST$="11111":ENTRY$=DAT$(CP%):GOSUB6500:GOSUB6180:CALL DSEND
2150 K%=1:GOSUB2770:K%=0
2160 GOSUB3300
2162 B$=INKEY$:IFB$=""GOTO2162
2164 GOSUB3350
2170 IFASC(B$)=30THENGOSUB2390:GOTO2130
2180 IFASC(B$)=31THENGOSUB2420:GOTO2130ELSEBEEP:GOTO2160
2195 GOSUB3350:RETURN1930
2200 GOSUB3350:RETURN2210 :'*RELEASE
2210 RC=FRE(""):IFCP%>50THENENTRY$="      "ELSEENTRY$=DAT$(CP%+1)
2220 GOSUB6500:CALL RBSNG
2230 IFSP%>50THENSP%=50
2231 FORI=1TO500:NEXTI:RC=PEEK(&HF37F):IFRC<>3GOTO2235
2232 CALL DSEND:GOTO2231
2235 B$="D":IFRC=0THENSP%=SP%+1:CP%=SP%:GOTO2150
2240 INTERVALOFF
2250 JJ$="      /      /     /RESET/MENU":IFB$="D"THENPRESET(8,168):COLOR15:PRINT#1," Release Error":BEEP:LINE(0,184)-(255,191),5,BF:PRESET(8,184):PRINT#1,JJ$ELSELOCATE0,21:PRINT" Release Error":PRINTTAB(32);:BEEP:LOCATE0,23:PRINTJJ$;
2280 ST$="00011":GOSUB3300:ONKEYGOSUB,,,2302,2320
2300 GOTO2300
2302 GOSUB3350:RETURN2304
2304 CALL DSEND:IFPEEK(&HF37F)<>0THEN2240ELSEIFB$="T"THEN1820ELSE2055
2310 GOSUB3350:RETURN880
2320 GOSUB3350:RETURN510
2330 GOSUB3350:SP%=SP%+5:CP%=SP%+1:GOSUB2420:RETURN2130
2360 GOSUB3350:SP%=SP%-5:CP%=SP%-1:GOSUB2390:RETURN2130
2390 IFCP%<2THENBEEP:CP%=1:SP%=1:RETURNELSESP%=SP%-1:CP%=SP%:RETURN
2420 IFCP%>50THENBEEP:CP%=51:SP%=51:RETURNELSESP%=SP%+1:CP%=SP%:RETURN
2480 X=22:Y=50:L=6:CX%=1:CP%=1:SP%=1:K%=1:GOSUB2770:K%=0
2510 ENTRY$=DAT$(CP%):ST$="11110":WC%=CW%(CP%-SP%+1):GOSUB3400:DAT$(CP%)=ENTRY$
2560 IFFKY=1THENRETURN2050
2570 IFFKY=2ORFKY=3THENGOSUB2970:GOTO2510
2590 IFFKY=4THENRETURN880
2600 IFASC(A$)=30THENGOSUB3070:GOTO2510
2610 IFASC(A$)=31THENGOSUB3180:GOTO2510
2620 CX%=CP%-SP%+1:IFCX%<>6THENCW%(CX%)=3:CW%(CX%+1)=8
2650 IFCP%=50THENRETURN2050
2660 CP%=CP%+1:IFY>120THENSP%=CP%-5:GOSUB2770:GOTO2700
2680 IFCX%=1THENGOSUB4910
2690 IS%=CX%:IX%=CX%+1:GOSUB4980:GOSUB2770:X=X+32:Y=Y+16
2700 IFVD%>=CP%-1GOTO2510ELSEVD%=CP%-1:GOTO2510
2770 FORI%=SP%TOSP%+5
2790 IFCX%>1ANDCX%<6ANDCX%>I%-SP%+1GOTO2950
2800 XX=(I%-SP%)*32+22:YY=(I%-SP%)*16+50:X1=XX+38:Y1=YY-22:DRAW "BM=X1;,=Y1;":LINE -STEP(24,8),CW%(I%-SP%+1),BF:COLOR15,CW%(I%-SP%+1):DRAW"BM=X1;,=Y1;"
2870 IFI%<51THENPRINT#1,RIGHT$(" "+STR$(I%),3)ELSEPRINT#1,"***"
2880 DRAW"BM=XX;,=YY;":LINE -STEP(48,8),CW%(I%-SP%+1),BF:DRAW"BM=XX;,=YY;"
2910 IFI%<51THENPRINT#1,DAT$(I%)
2920 IFCX%=1ANDK%=1GOTO2950
2930 IFCX%=1ANDI%=SP%+1THENI%=SP%+5:GOTO2950
2940 IFCX%<>6ANDCX%=I%-SP%THENI%=SP%+5
2950 NEXTI%:RETURN
2970 CX%=CP%-SP%:IFFKY=3THENWX%=6ELSEWX%=-6
3000 SP%=SP%+WX%:WX%=X:WY%=Y
3020 IFSP%<1THENSP%=1
3030 IFSP%>45THENSP%=45
3040 CP%=SP%+CX%:CX%=1:X=22:Y=50:K%=1:GOSUB2770:K%=0:X=WX%:Y=WY%:RETURN
3070 IFCP%<2THENBEEP:CP%=1:SP%=1:X=22:Y=50:RETURN
3090 IFSP%=CP%GOTO3130
3100 CX%=CP%-SP%:CW%(CX%)=8:CW%(CX%+1)=3:IS%=CX%:IX%=CX%+1:IFCP%=SP%+1THENGOSUB4910
3120 GOSUB4980:GOSUB2770:CP%=CP%-1:X=X-32:Y=Y-16:RETURN
3130 SP%=SP%-1:CP%=SP%:X=22:Y=50:K%=1:GOSUB2770:K%=0:RETURN
3180 IFCP%>49THENBEEP:CP%=50:SP%=45:X=32*5+22:Y=16*5+50:RETURN
3200 CX%=CP%-SP%+1:IFSP%+5=CP%GOTO3250
3220 CW%(CX%)=3:CW%(CX%+1)=8:IS%=CX%:IX%=CX%+1:IFCP%=SP%THENGOSUB4910
3240 GOSUB4980:GOSUB2770:CP%=CP%+1:X=X+32:Y=Y+16:RETURN
3250 SP%=SP%+1:CP%=SP%+5:X=32*5+22:Y=16*5+50:K%=1:GOSUB2770:K%=0:RETURN
3300 GOSUB3350:GOSUB3395
3305 IFINKEY$<>""THEN3300
3310 FORI%=1TO5
3320 IFMID$(ST$,I%,1)="1"THENKEY(I%)ONELSEKEY(I%)OFF
3330 NEXTI%:RETURN
3345 FORI%=1TO5
3346 IFMID$(ST$,I%,1)="1"THENKEYI%,CHR$(I%)ELSEKEYI%,"**"
3347 NEXTI%:RETURN
3350 FORI%=1TO5:KEY(I%)OFF:NEXTI%:RETURN
3395 FORI%=1TO5:KEYI%,"**":NEXTI%:RETURN
3400 COLOR15,WC%:CCSR%=1:FKY=0:DRAW"BM=X;,=Y;":PRINT#1,ENTRY$;:DRAW"BM=X;,=Y;"
3460 LINE -STEP(7,8),15,BF:DRAW"BM-7,-8":COLORWC%,15
3490 IFL+1=CCSR%THENPRINT#1," ";ELSEPRINT#1,MID$(ENTRY$,CCSR%,1);
3500 COLOR15,WC%
3510 GOSUB3345
3512 A$=INKEY$:IFA$=""THEN3512
3513 GOSUB3395
3514 IFASC(A$)>5GOTO3520
3515 FKY=ASC(A$):GOTO4160
3520 IFASC(A$)=13GOTO4160
3530 IFASC(A$)=8GOTO3720
3540 IFASC(A$)=127GOTO3720
3550 IFASC(A$)=28GOTO3990
3560 IFASC(A$)=29GOTO4060
3600 IFASC(A$)=30GOTO4160
3610 IFASC(A$)=31GOTO4160
3620 IFINSTR("0123456789- ",A$)=0THENBEEP:GOTO3510
3630 IFL+1=CCSR%THENBEEP:GOTO3510
3640 GOSUB4200:COLOR15,WC%:PRINT#1,A$;:MID$(ENTRY$,CCSR%,1)=A$
3700 CCSR%=CCSR%+1:GOTO3460
3720 IFCCSR%=1THENBEEP:GOTO3510
3910 A$=" "
3920 MID$(ENTRY$,CCSR%-1,1)=A$:GOSUB4200
3935 IFCCSR%=7THENDRAW"BM-8,-0":GOTO3970
3940 COLOR15,WC%:PRINT#1,MID$(ENTRY$,CCSR%,1);:DRAW"BM-16,-0"
3970 CCSR%=CCSR%-1:GOTO3460
3990 IFL+1=CCSR%THENBEEP:GOTO3510
4010 GOSUB4200:COLOR15,WC%:PRINT#1,MID$(ENTRY$,CCSR%,1);
4040 CCSR%=CCSR%+1:GOTO3460
4060 IFCCSR%=1THENBEEP:GOTO3510
4080 GOSUB4200:IFL+1=CCSR%THENDRAW"BM-8,-0":GOTO4140
4100 COLOR15,WC%:PRINT#1,MID$(ENTRY$,CCSR%,1);:DRAW"BM-16,-0"
4140 CCSR%=CCSR%-1:GOTO3460
4160 GOSUB4200:COLOR15,WC%:PRINT#1,MID$(ENTRY$,CCSR%,1);:RETURN
4200 DRAW"BM-8,-0":LINE -STEP(7,8), WC%,BF:DRAW "BM-7,-8":RETURN
4360 CLS:COLOR15,5,7:SCREEN2:CIRCLE(64,40),32,3:COLOR3:DRAW"BM64,13F4G4H4E4":PAINTSTEP(0,2),3:PSET(64,40),15:DRAW"U4":LINE -STEP(14,-16):DRAW"R2D2":LINE -STEP(-12,18):DRAW"L4":PAINTSTEP(2,-1),3
4530 DRAW"BM33,81R70D16R16D16R16D30L70U16L16U16L16U30":PAINTSTEP(2,2),3:COLOR15:DRAW"BM32,80R72D32L72U32":DRAW"BM104,96R16D32L72U16":DRAW"BM120,112R16D32L72U16":RETURN
4600 CLS:COLOR15,5:SCREEN1:WIDTH32:KEYOFF:LOCATE4,0:PRINTSTRING$(22,"*"):FORI%=1TO9:LOCATE4,I%:PRINT"*";:LOCATE25,I%:PRINT"*":NEXTI%:LOCATE4,10:PRINTSTRING$(22,"*");
4680 LOCATE6,2:PRINT"S E L F  ";SY$;":";SM$;" ";SD$;CHR$(34):LOCATE6,4:PRINT"INTERVAL ";IY$;":";IM$;" ";ID$;CHR$(34):LOCATE6,6:PRINT"B U L B  ";EY$;":";EM$;" ";ED$;CHR$(34):LOCATE6,8:PRINT"FRAMES         ";FR$:RETURN
4800 CLS:COLOR15,5:SCREEN2
4860 GOSUB5510:CW%(1)=8:GOSUB4910:IS%=2:IX%=6:GOSUB4980:RETURN
4910 COLOR15,5:LINE(16,24)-(87,63),15,B:LINE(17,25)-(86,62),15,B:COLORCW%(1):LINE(18,26)-(85,61),CW%(1),BF:RETURN
4980 FORI%=IS%TOIX%
4990 X1=(I%-2)*32+88:Y1=(I%-1)*16+24:PRESET(X1,Y1):COLORCW%(I%):DRAW"R31D39L71U15R40U24":PAINTSTEP(2,2),CW%(I%)
5050 PRESET(X1,Y1):COLOR15:DRAW"R31D39L71U15":PRESET(X1,Y1+1):COLOR15:DRAW"R30D37L69U14"
5110 NEXTI%:RETURN
5160 LOCATE12,23:IFXA%=0THENPRINT" ON  ";:LOCATE6,17:PRINTTAB(31);:ENTRY$="      ":GOSUB6500:GOSUB6190:CALL DSEND:RETURN
5200 PRINT" OFF ";:LOCATE6,17:PRINT"IMPRINT DATA ";DAT$(CP%):GOSUB6180:ENTRY$=DAT$(CP%):GOSUB6500:CALL DSEND
5240 RETURN
5280 IFXA%=0THENXA%=1ELSEXA%=0
5300 RETURN
5340 LINE(177,81)-(183,87),15,BF:LINE(177,105)-(183,111),5,BF:COLOR15:RETURN
5430 LINE(177,81)-(183,87),5,BF:LINE(177,105)-(183,111),15,BF:RETURN
5510 FORI%=1TO6:CW%(I%)=3:NEXTI%:RETURN
5590 IFTI+TE=0GOTO5825
5600 ONINTERVAL=60GOSUB5640
5610 RC=FRE(""):RC=0:INTERVALON:
5620 IFTS=0GOTO5680
5630 GOTO5630
5640 RETURN5650
5650 HMS=HMS-1
5651 IFHMS=0THEN5670
5652 IFHMS<0THEN2240
5653 HH%=HMS/3600:SS%=HMS-HH%*3600:MM%=SS%\60:SS%=SS%-MM%*60
5657 LOCATE15,12:PRINTRIGHT$(STR$(HH%),2);":";RIGHT$(STR$(MM%),2);" ";RIGHT$(STR$(SS%),2);
5658 IFPEEK(&HF37F)<>3THENI%=FRE("")ELSECALL DSEND
5660 GOTO5660
5670 ONK%GOTO5680,5750
5680 IFPEEK(&HF37F)=3THENINTERVALOFF:GOTO2240
5690 IFXA%<>0THENCP%=CP%+1:IFCP%<52THENENTRY$=DAT$(CP%):GOSUB6500ELSECP%=51
5702 IFTE=0GOTO5745
5703 CALL RBCNT
5705 RC=PEEK(&HF37F)
5707 IFRC=2THENIFXA%<>0THENCP%=CP%-1:GOTO5730ELSEGOTO5730
5708 IFRC=3GOTO5720
5710 IFRC<>0THENINTERVALOFF:IFXA%<>0THENCP%=CP%-1:GOTO2240ELSE2240
5720 GOSUB6110
5730 IFTE=0THENGOTO5780ELSEGOSUB6050
5740 GOTO5740
5745 CALL RBSNG:RC=PEEK(&HF37F)
5746 IF RC=2THEN5747ELSE5708
5747 CP%=CP%-1:GOTO5820
5750 IFPEEK(&HF37F)=3THENCALL RBOFF:CALL DSEND:GOTO5780
5770 CALL RBOFF:IFPEEK(&HF37F)=1THENINTERVALOFF:GOTO2240
5780 IFFF%=0THENINTERVAL OFF:GOSUB7000
5790 IFXA%=0GOTO5820
5810 LOCATE19,17:PRINTDAT$(CP%)
5820 IFTI=0THENGOTO5690ELSEGOSUB5990
5822 IFRC<>2THEN5824
5823 CALL DSEND:IFPEEK(&HF37F)=3THEN5823ELSECALLRBOFF
5824 GOTO5824
5825 IFTS=0GOTO5832
5826 ONINTERVAL=60GOSUB5829
5827 RC=0:INTERVALON
5828 GOTO5828
5829 RETURN5830
5830 HMS=HMS-1:HH%=HMS/3600:SS%=HMS-HH%*3600:MM%=SS%\60:SS%=SS%-MM%*60:LOCATE15,12:PRINTRIGHT$(STR$(HH%),2);":";RIGHT$(STR$(MM%),2);" ";RIGHT$(STR$(SS%),2);:IFHMS<>0GOTO 5828
5831 INTERVALOFF
5832 IFXA%<>0THENCP%=CP%+1:IFCP%<52THENENTRY$=DAT$(CP%):GOSUB6500ELSECP%=51
5833 CALL RBSNG:GOSUB6110:IFFF%=0THENGOSUB7000
5834 IFXA%<>0THENLOCATE19,17:PRINTDAT$(CP%)
5835 FORI=1TO300:NEXTI
5836 RC=PEEK(&HF37F):IFRC=3THENCALL DSEND:GOTO5835
5837 IFRC=0THEN5832ELSE2240
5940 HMS=TS:K%=1:LOCATE6,12:PRINT"S E L F  ";SY$;":";SM$;" ";SD$;CHR$(34):RETURN
5990 HMS=TI:K%=1:LOCATE6,12:PRINT"INTERVAL ";IY$;":";IM$;" ";ID$;CHR$(34):RETURN
6050 HMS=TE:K%=2:LOCATE6,12:PRINT"B U L B  ";EY$;":";EM$;" ";ED$;CHR$(34):RETURN
6110 FF%=FF%-1:LOCATE21,15:PRINTRIGHT$(STR$(FF%),2);:RETURN
6180 POKE &HF37E,&HFF:RETURN
6190 POKE &HF37E,&H0 :RETURN
6500 J=&HF36E:L=6
6660 FORI%=1TOL:POKEJ,ASC(MID$(ENTRY$,I%,1)):J=J+1:NEXTI%:RETURN
6710 CCSR%=1:FKY=0
6720 LOCATEX,Y,0:PRINTENTRY$
6730 GOSUB3345:LOCATEX+CCSR%-1,Y:A$=INPUT$(1):GOSUB3395
6732 IFASC(A$)>5GOTO6748
6734 FKY=ASC(A$):RETURN
6748 IFASC(A$)=13THENRETURN
6750 IFASC(A$)=8GOTO6900
6760 IFASC(A$)=128GOTO6900
6770 IFASC(A$)=28GOTO6850
6780 IFASC(A$)=29GOTO6870
6790 IFA$<"0"ORA$>"9"THENBEEP:GOTO6730
6800 MID$(ENTRY$,CCSR%,1)=A$:IFL=CCSR%GOTO6720
6820 IFCCSR%=2ORCCSR%=5THENCCSR%=CCSR%+1
6830 CCSR%=CCSR%+1:GOTO6720
6850 IFL=CCSR%THENBEEP:GOTO6730
6860 GOTO6820
6870 IFCCSR%=1THENBEEP:GOTO6730
6880 IFCCSR%=4ORCCSR%=7THENCCSR%=CCSR%-1
6890 CCSR%=CCSR%-1:GOTO6730
6900 IFCCSR%=1THENBEEP:GOTO6730
6910 IFL=CCSR%THENIFMID$(ENTRY$,CCSR%,1)="0"GOTO6940ELSEMID$(ENTRY$,CCSR%,1)="0":GOTO6720
6920 IFCCSR%=2ORCCSR%=5GOTO6940
6930 CCSR%=CCSR%-1
17179 CSR%=CCSR%-1:MID$(ENTRY$,CCSR%,1)="0":GOTO6720
7000 FORI=1TO100:NEXTI:IFPEEK(&HF37F)<>3THEN7020ELSECALLDSEND
7015 GOTO 7000
7020 IF PEEK(&HF37F)=0THEN 1810 ELSE2240
7999 ONFKYGOTO,,,885,1930:RETURN
